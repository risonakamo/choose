import{cursorEnd}from"./index.js";export class WdMain extends React.Component{constructor(a){super(a),this.addChoice=this.addChoice.bind(this),this.mainKeys=this.mainKeys.bind(this),this.deleteChoice=this.deleteChoice.bind(this),this.state={choices:[]},this.titleRef=React.createRef(),this.choicesId=0,this.choiceRefs={}}componentDidMount(){this.titleRef.current.focus()}addChoice(a){this.choicesId++,this.state.choices.splice(this.state.choices.indexOf(a)+1,0,this.choicesId),this.setState({choices:this.state.choices})}deleteChoice(a){delete this.choiceRefs[a];var b=this.state.choices.indexOf(a);this.state.choices.splice(b,1),0==b?(this.titleRef.current.focus(),cursorEnd()):this.choiceRefs[this.state.choices[b-1]].focus(),this.setState({choices:this.state.choices})}mainKeys(a,b,c=!1){"Enter"==a.key?(a.preventDefault(),!c&&this.addChoice(b)):"Backspace"==a.key&&0==window.getSelection().anchorOffset&&0<b&&(a.preventDefault(),this.deleteChoice(b))}render(){var a="";return 2<=this.state.choices.length&&(a="show"),React.createElement(React.Fragment,null,React.createElement("div",{className:"title",contentEditable:"",onKeyDown:a=>{this.mainKeys(a,0)},ref:this.titleRef}),this.state.choices.map((a,b)=>React.createElement(Choice,{number:b+1,key:a,cid:a,mainKeys:this.mainKeys,addChoice:this.addChoice,ref:b=>{!this.choiceRefs[a]&&b&&(this.choiceRefs[a]=b,b.focus())}})),React.createElement("div",{className:`ender ${a}`},React.createElement("i",null,"Ctrl+Enter to Choose")))}}class Choice extends React.Component{constructor(a){super(a),this.focus=this.focus.bind(this),this.checkEmpty=this.checkEmpty.bind(this),this.maininput=React.createRef()}focus(){this.maininput.current.focus(),cursorEnd()}checkEmpty(){return!(""!=this.maininput.current.innerText)}render(){return React.createElement("div",{className:"choice"},React.createElement("span",null,this.props.number),React.createElement("div",{className:"input",contentEditable:"",onKeyDown:a=>{this.props.mainKeys(a,this.props.cid,this.checkEmpty())},ref:this.maininput}))}}